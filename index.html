<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Miami Ready: Architect Edition</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üçë</text></svg>">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body x-data="app()" x-init="init()">

    <div class="app" :class="{ 'workout-active': workoutMode, 'stability-alert': currentPainLevel > 3 }">
        
        <template x-if="view === 'today' && !workoutMode">
            <div class="view-today" x-transition>
                
                <header class="architect-header">
                    <div class="status-group">
                        <span class="status-label" x-text="physiqueStatus"></span>
                        <h1 x-text="todaySchedule.label"></h1>
                    </div>
                    <div class="countdown-circle">
                        <span class="days-left" x-text="70 - currentDay"></span>
                        <span class="unit">DAYS</span>
                    </div>
                </header>

                <section class="control-panel">
                    <div class="pain-slider-card">
                        <div class="card-header">
                            <span>Back Stability</span>
                            <span class="pain-value" x-text="currentPainLevel + '/10'"></span>
                        </div>
                        <input type="range" min="0" max="10" x-model="currentPainLevel" @change="handleBackPain($el.value)">
                        <p x-show="currentPainLevel > 3" class="warning-text">‚ö†Ô∏è Stability Mode: Exercises Swapped</p>
                    </div>
                    
                    <button @click="showSwapModal = true" class="btn-pivot">
                        <span>üîÑ Pivot Schedule</span>
                    </button>
                </section>

                <section class="metrics-grid">
                    <div class="metric-card">
                        <span class="m-label">Roundness</span>
                        <span class="m-value" x-text="(latestScan?.roundness || baseline.roundness) + '%'"></span>
                    </div>
                    <div class="metric-card">
                        <span class="m-label">Protrusion</span>
                        <span class="m-value" x-text="(latestScan?.protrusion || baseline.protrusion) + '%'"></span>
                    </div>
                    <div class="metric-card">
                        <span class="m-label">Lift Score</span>
                        <span class="m-value" x-text="(latestScan?.lift || baseline.lift) + '%'"></span>
                    </div>
                </section>

                <div class="action-area">
                    <button class="btn-primary" @click="startWorkout()">
                        <span x-text="todaySchedule.type === 'tempo' ? 'Log Recovery' : 'Start Sculpting'"></span>
                    </button>
                </div>
            </div>
        </template>

        <template x-if="showSwapModal">
            <div class="modal-overlay" @click.self="showSwapModal = false">
                <div class="modal-content">
                    <h3>Switch Today's Focus</h3>
                    <p>Changing your schedule for real-life adjustments (like StretchLab).</p>
                    <div class="swap-options">
                        <button @click="pivotDay('tempo')" class="btn-opt">Recovery / StretchLab</button>
                        <button @click="pivotDay('lower')" class="btn-opt">Stability (Lower C)</button>
                        <button @click="pivotDay('upper')" class="btn-opt">Upper Body</button>
                    </div>
                    <button @click="showSwapModal = false" class="btn-close">Cancel</button>
                </div>
            </div>
        </template>

        <nav class="bottom-nav" x-show="!workoutMode">
            <button class="nav-item" :class="{ active: view === 'today' }" @click="view = 'today'">üè†</button>
            <button class="nav-item" :class="{ active: view === 'plan' }" @click="view = 'plan'">üìÖ</button>
            <button class="nav-item" :class="{ active: view === 'progress' }" @click="view = 'progress'">üìä</button>
        </nav>
    </div>

    <script src="app.js"></script>
</body>
</html>
